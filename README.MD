# ExcelCopy и ExcelWriter

## Описание

Этот проект предоставляет инструменты для работы с Excel-документами, включая:

1. **ExcelCopy** — выполняет физическое копирование существующего шаблона Excel и добавляет данные в копию.
2. **ExcelWriter** — открывает существующий шаблон Excel, копирует его данные и форматирование, создает новый файл и добавляет данные.

Эти классы полезны для автоматизации задач, связанных с обработкой и генерацией Excel-документов.

---

## Возможности

### ExcelCopy

- Простое копирование шаблона Excel.
- Добавление данных в копию файла без изменения оригинала.
- Подходит для простых сценариев, где форматирование остаётся неизменным.

### ExcelWriter

- Копирование содержимого и форматирования из шаблона Excel.
- Создание нового файла на основе шаблона.
- Гибкое добавление данных с настройкой ширины столбцов, высоты строк и формул.
- Полное копирование форматирования: шрифтов, цветов, размеров.

---

## Установка

Убедитесь, что установлены все необходимые библиотеки. Для установки используйте одну из следующих команд:

### С помощью poetry

poetry add openpyxl xlsxwriter

# Классы
### 1. ExcelCopy   
Класс ExcelCopy создаёт физическую копию существующего шаблона Excel. Все изменения производятся на копии, не затрагивая оригинальный файл.

Основные методы:  
__init__(template_path, output_path)
Конструктор класса.

template_path — путь к исходному шаблону Excel.  
output_path — путь для сохранения копии.  
create_copy()  
Создаёт физическую копию шаблона по указанному пути.

update_excel(updates)  
Вносит изменения в копию.  
Параметр updates — словарь вида {ячейка: значение}, где ключ — адрес ячейки, а значение — данные для вставки.

### 2. ExcelWriter
Класс ExcelWriter копирует содержимое и стили из шаблона Excel, создаёт новый файл, добавляет данные и выполняет настройку документа.

Основные методы:  
__init__(file_path=None, options=None)
Конструктор класса.

file_path — путь к шаблону Excel.  
Если путь не указан, используется метод _default_file_path().  
options — дополнительные параметры для xlsxwriter (например, in_memory=True).  
write(new_filename)  
Создаёт новый файл Excel на основе шаблона, добавляет данные и сохраняет их в new_filename.

_copy(workbook)  
Копирует содержимое и стили из шаблона в новую рабочую книгу.
Включает копирование:

Данных.  
Стилей ячеек.  
Ширины столбцов и высоты строк.  
_get_cell_format(cell)  
Преобразует форматирование ячейки из шаблона в словарь, который можно применить в новой книге.

add(workbook)  
Добавляет данные в новый файл Excel. Требует переопределения в дочерних классах.

configuration(workbook)  
Настраивает документ: ширину столбцов, высоту строк, стили, формулы. Может быть переопределён в дочерних классах.